\newcommand{\modla}{\mathsf a}
\newcommand{\readseta}{\mathsf {Rda}}
\newcommand{\writeseta}{\mathsf {Wra}}
\newcommand{\valuseta}{\mathsf {Va}}

Alongside commutativity, associativity is a desirable property of a parallel composition operator. If the operator defined in Section~\ref{sec:interpretation} is clearly commutative, whether it is associative does not strike the eye. In fact, a detailed proof of it is rather cumbersome. We present it here.

\begin{proposition}\label{prop:associativity}
$\modl \intPgm{ \pi_1 \pll (\pi_2 \pll \pi_3) } \modl'$ iff $\modl \intPgm{ (\pi_1 \pll \pi_2) \pll \pi_3 } \modl'$.
\end{proposition}
\begin{proof}


  \begin{figure}[h]
    \centering
    \begin{tabular}{lcl}
      $\exists \modl_1, \modl_*, \modl_2, \modl_3, \modl'_1, \modl'_2, \modl'_3, \modl'_*$': &  ~~~~~\emph{iff}~~~~~&    $\exists \modla_\#, \modla_3, \modla_1, \modla_2, \modla_1', \modla_2', \modla_\#', \modla_3'$:\\
      \input{figure-associativity1.tex}
      & ~ &
      \input{figure-associativity2.tex}
    \end{tabular}
    \caption{\label{fig:illustration-associativity} Illustration of associativity. Visual aid for the proof of Proposition~\ref{prop:associativity}.}
  \end{figure}
  
%% \begin{figure}[h]
%% \begin{verbatim}
%%     exist m1, m*, m2, m3, m'1, m'2, m'3, m'*:

%%        m1-----------pi1-----------m'1
%%       /                             \
%%    m /                               \ m'
%%      \                               /
%%       \     m2-----pi2-----m'2      /
%%        \   /                  \    /
%%         m*/                    \m'*
%%           \                    /
%%            \                  /
%%             m3-----pi3-----m'3


%%     iff exist a#, a3, a1, a2, a'1, a'2, a'#, a'3:

%%             a1-----pi1-----a'1
%%            /                  \
%%         a#/                    \a'#
%%        /  \                    /  \
%%       /    \                  /    \
%%    m /      a2-----pi2-----a'2      \ m'
%%      \                              /
%%       \                            /
%%        a3-----------pi3-----------a'3

%% \end{verbatim}
%% \caption{\label{fig:illustration-associativity-ascii} Illustration of associativity. Visual aid for the proof of Proposition~\ref{prop:associativity}.}
%% \end{figure}

Figure~\ref{fig:illustration-associativity} illustrates precisely what we are going to show.
  %
Suppose $\modl = \tuple{\readset, \writeset, \valuset}$ and $\modl' = \tuple{\readset', \writeset', \valuset'}$.




\paragraph{Left-hand side.} $\modl \intPgm{ \pi_1 \pll (\pi_2 \pll \pi_3) } \modl'$.

There are $\modl_1, \modl_*, \modl'_1, \modl'_*$ such that (with, $\modl_1 = \tuple{\readset_1, \writeset_1, \valuset_1}$, $\modl'_1 = \tuple{\readset'_1, \writeset'_1, \valuset'_1}$, $\modl_* = \tuple{\readset_*, \writeset_*, \valuset_*}$, $\modl'_* = \tuple{\readset'_*, \writeset'_*, \valuset'_*}$):
\begin{enumerate}
\item\label{i:split-merge1}\label{i:lhsfirst} $\splt{\modl}{\modl_1} {\modl_*}$
  and $\mrg{\modl'}{\modl'_1} {\modl'_*}$ 
\item $\modl_1 \intPgm{ \pi_1 } \modl'_1$
\item $\readset_1 = \readset'_1$
  and $\writeset_1 = \writeset'_1$
  and $\valuset_1 \setminus \writeset_1 = \valuset'_1 \setminus \writeset'_1$
\item\label{i:pi2pi3} $\modl_* \intPgm{ \pi_2 \pll \pi_3 } \modl'_*$ 
\item $\readset_* = \readset'_*$
  and $\writeset_* = \writeset'_*$ 
  and $\valuset_* \setminus \writeset_* = \valuset'_* \setminus \writeset'_*$
\end{enumerate}
Item~\ref{i:pi2pi3} is equivalent to: there are $\modl_2, \modl_3, \modl'_2, \modl'_3$ such that  (with, $\modl_2 = \tuple{\readset_2, \writeset_2, \valuset_2}$, $\modl'_2 = \tuple{\readset'_2, \writeset'_2, \valuset'_2}$, $\modl_3 = \tuple{\readset_3, \writeset_3, \valuset_3}$, $\modl'_3 = \tuple{\readset'_3, \writeset'_3, \valuset'_3}$):
\begin{enumerate}[resume]
\item\label{i:split-merge2} $\splt{\modl_*}{\modl_2} {\modl_3} $ and $\mrg{\modl_*'}{\modl'_2} {\modl'_3} $
\item $\modl_2 \intPgm{ \pi_2 } \modl'_2$, 
\item $\readset_2 = \readset'_2 $ and $\writeset_2 = \writeset'_2 $ and $\valuset_2 \setminus \writeset_2 = \valuset'_2 \setminus \writeset'_2$
\item $\modl_3 \intPgm{ \pi_3 } \modl'_3$, 
\item $\readset_3 = \readset'_3 $ and $\writeset_3 = \writeset'_3 $ and $\valuset_3 \setminus \writeset_3 = \valuset'_3 \setminus \writeset'_3$
\end{enumerate}
Item~\ref{i:split-merge1} is $\splt{\modl}{\modl_1} {\modl_*} $ and $\mrg{\modl'}{\modl'_1} {\modl'_*} $ iff:
\begin{enumerate}[resume]
\item
  %%%% split
  $\writeset_1 \cap \readset_* = \writeset_* \cap \readset_1 = \emptyset$ ($\modl_1$ and $\modl_*$ are RW-compatible)
  \item 
    $\readset = \readset_1 \cup \readset_* $, and $\writeset = \writeset_1 \cup \writeset_*$, and $\valuset = \valuset_1 = \valuset_*$

    %%%% merge
    
    \item $\writeset'_1 \cap \readset'_* = \writeset'_* \cap \readset'_1 = \emptyset$ ($\modl'_1$ and $\modl'_*$ are RW-compatible)
    \item $\readset' = \readset'_1 \cup \readset'_*$, $\writeset' = \writeset'_1 \cup \writeset'_*$, and $\valuset'_1 \setminus \writeset' = \valuset'_* \setminus \writeset'$, and $\valuset' = (\valuset'_1 \cap \writeset'_1) \cup (\valuset'_* \cap \writeset'_*) \cup (\valuset'_1 \cap \valuset'_*) $ 
\end{enumerate}
Item~\ref{i:split-merge2} is $\splt{\modl}{\modl_2} {\modl_3} $ and $\mrg{\modl'}{\modl'_2} {\modl'_3} $ iff:
\begin{enumerate}[resume]
\item
  %%%% split
  $\writeset_2 \cap \readset_3 = \writeset_3 \cap \readset_2 = \emptyset$ ($\modl_2$ and $\modl_3$ are RW-compatible)
  \item 
    $\readset_* = \readset_2 \cup \readset_3 $, and $\writeset_* = \writeset_2 \cup \writeset_3$, and $\valuset_* = \valuset_2 = \valuset_3$

    %%%% merge
    
    \item $\writeset'_2 \cap \readset'_3 = \writeset'_3 \cap \readset'_2 = \emptyset$ ($\modl'_2$ and $\modl'_3$ are RW-compatible)
    \item\label{i:lhslast} $\readset_*' = \readset'_2 \cup \readset'_3$, $\writeset_*' = \writeset'_2 \cup \writeset'_3$, and $\valuset'_2 \setminus \writeset_*' = \valuset'_3 \setminus \writeset_*'$, and $\valuset_*' = (\valuset'_2 \cap \writeset'_2) \cup (\valuset'_3 \cap \writeset'_3) \cup (\valuset'_2 \cap \valuset'_3) $ 
\end{enumerate}


\paragraph{Right-hand side.} $\modl \intPgm{ (\pi_1 \pll \pi_2) \pll \pi_3 } \modl'$.

There are $\modla_\#, \modla_3, \modla_\#', \modla_3'$ such that
(with, $\modla_\# = \tuple{\readseta_\#, \writeseta_\#, \valuseta_\#}$, $\modla'_\# = \tuple{\readseta'_\#, \writeseta'_\#, \valuseta'_\#}$, $\modla_3 = \tuple{\readseta_3, \writeseta_3, \valuseta_3}$, $\modla'_3 = \tuple{\readseta'_3, \writeseta'_3, \valuseta'_3}$):
\begin{enumerate}[resume]
\item\label{i:split-merge3}\label{i:rhsfirst} $\splt{\modl}{\modla_\#} {\modla_3}$
  and $\mrg{\modl'}{\modla'_\#} {\modla'_3}$ 
\item\label{i:pi1pi2} $\modla_\# \intPgm{ \pi_1 \pll \pi_2} \modla'_\#$
\item $\readseta_\# = \readseta'_\#$
  and $\writeseta_\# = \writeseta'_\#$
  and $\valuseta_\# \setminus \writeseta_\# = \valuseta'_\# \setminus \writeseta'_\#$
\item $\modla_3 \intPgm{ \pi_3 } \modla'_3$ 
\item $\readseta_3 = \readseta'_3$
  and $\writeseta_3 = \writeseta'_3$ 
  and $\valuseta_3 \setminus \writeseta_3 = \valuseta'_3 \setminus \writeseta'_3$
\end{enumerate}
Item~\ref{i:pi1pi2} is equivalent to:
there are $\modla_1, \modla_2, \modla'_1, \modla'_2$ such that 
(with, $\modla_1 = \tuple{\readseta_1, \writeseta_1, \valuseta_1}$, $\modla'_1 = \tuple{\readseta'_1, \writeseta'_1, \valuseta'_1}$, $\modla_2 = \tuple{\readseta_2, \writeseta_2, \valuseta_2}$, $\modla'_2 = \tuple{\readseta'_2, \writeseta'_2, \valuseta'_2}$):
\begin{enumerate}[resume]
\item\label{i:split-merge4} $\splt{\modla_\#}{\modla_1} {\modla_2}$
  and $\mrg{\modla'_\#}{\modla'_1} {\modla'_2}$ 
\item $\modla_1 \intPgm{ \pi_1} \modla'_1$
\item $\readseta_1 = \readseta'_1$
  and $\writeseta_1 = \writeseta'_1$
  and $\valuseta_1 \setminus \writeseta_1 = \valuseta'_1 \setminus \writeseta'_1$
\item $\modla_2 \intPgm{ \pi_2 } \modla'_2$ 
\item $\readseta_2 = \readseta'_2$
  and $\writeseta_2 = \writeseta'_2$ 
  and $\valuseta_2 \setminus \writeseta_2 = \valuseta'_2 \setminus \writeseta'_2$
\end{enumerate}
Item~\ref{i:split-merge3} is $\splt{\modl}{\modla_\#} {\modla_3}$ and $\mrg{\modl'}{\modla'_\#} {\modla'_3}$ iff:
\begin{enumerate}[resume]
\item
  %%%% split
  $\writeseta_\# \cap \readseta_3 = \writeseta_3 \cap \readseta_\# = \emptyset$ ($\modla_\#$ and $\modla_3$ are RW-compatible)
  \item 
    $\readset = \readseta_\# \cup \readseta_3 $, and $\writeset = \writeseta_\# \cup \writeseta_3$, and $\valuset = \valuseta_\# = \valuseta_3$

    %%%% merge
    
    \item $\writeseta'_\# \cap \readseta'_3 = \writeseta'_3 \cap \readseta'_\# = \emptyset$ ($\modla'_\#$ and $\modla'_3$ are RW-compatible)
    \item $\readset' = \readseta'_\# \cup \readseta'_3$, $\writeset' = \writeseta'_\# \cup \writeseta'_3$, and $\valuseta'_\# \setminus \writeset' = \valuseta'_3 \setminus \writeset'$, and $\valuset' = (\valuseta'_\# \cap \writeseta'_\#) \cup (\valuseta'_3 \cap \writeseta'_3) \cup (\valuseta'_\# \cap \valuseta'_3) $ 
\end{enumerate}
Item~\ref{i:split-merge4} is $\splt{\modla_\#}{\modla_1} {\modla_2}$ and $\mrg{\modla'_\#}{\modla'_1} {\modla'_2}$ iff:
\begin{enumerate}[resume]
\item
  %%%% split
  $\writeseta_1 \cap \readseta_2 = \writeseta_2 \cap \readseta_1 = \emptyset$ ($\modla_1$ and $\modla_2$ are RW-compatible)
  \item 
    $\readseta_\# = \readseta_1 \cup \readseta_2 $, and $\writeseta_\# = \writeseta_1 \cup \writeseta_2$, and $\valuseta_\# = \valuseta_1 = \valuseta_2$

    %%%% merge
    
    \item $\writeseta'_1 \cap \readseta'_2 = \writeseta'_2 \cap \readseta'_1 = \emptyset$ ($\modla'_1$ and $\modla'_2$ are RW-compatible)
    \item\label{i:rhslast} $\readseta_\#' = \readseta'_1 \cup \readseta'_2$, $\writeseta_\#' = \writeseta'_1 \cup \writeseta'_2$, and $\valuseta'_1 \setminus \writeseta_\#' = \valuseta'_2 \setminus \writeseta_\#'$, and $\valuseta_\#' = (\valuseta'_1 \cap \writeseta'_1) \cup (\valuseta'_2 \cap \writeseta'_2) \cup (\valuseta'_1 \cap \valuseta'_2) $ 
\end{enumerate}


\paragraph{Left to right.}

Suppose lhs. We define:
\begin{itemize} 
\item $\modla_\# = \tuple{\readseta_\#, \writeseta_\#, \valuseta_\#} = \tuple{\readset_1 \cup \readset_2, \writeset_1 \cup \writeset_2, \valuset}$
\item $\modla_1 = \tuple{\readseta_1, \writeseta_1, \valuseta_1} = \modl_1 = \tuple{\readset_1, \writeset_1, \valuset}$
\item $\modla_2 = \tuple{\readseta_2, \writeseta_2, \valuseta_2} = \modl_2 = \tuple{\readset_2, \writeset_2, \valuset}$
\item $\modla_3 = \tuple{\readseta_3, \writeseta_3, \valuseta_3} = \modl_3 = \tuple{\readset_3, \writeset_3, \valuset}$
\item $\modla'_\# = \tuple{\readseta'_\#, \writeseta'_\#, \valuseta'_\#} = \tuple{\readset'_1 \cup \readset'_2, \writeset'_1 \cup \writeset'_2, (\valuset'_1 \cap \writeset_1) \cup (\valuset'_2 \cap \writeset_2) \cup (\valuset'_1 \cap \valuset'_2)}$
\item $\modla'_1 = \tuple{\readseta'_1, \writeseta'_1, \valuseta'_1) = \modl'_1 = (\readset'_1, \writeset'_1, \valuset'_1}$
\item $\modla'_2 = \tuple{\readseta'_2, \writeseta'_2, \valuseta'_2} = \modl'_2 = \tuple{\readset'_2, \writeset'_2, \valuset'_2}$
\item $\modla'_3 = \tuple{\readseta'_3, \writeseta'_3, \valuseta'_3} = \modl'_3 = \tuple{\readset'_3, \writeset'_3, \valuset'_3}$ 
\end{itemize}

We must show that these models satisfy all the properties from~\ref{i:rhsfirst} through~\ref{i:rhslast}.
\begin{itemize}
\item[19] if and only if
  \begin{itemize}
  \item[29]  $\writeseta_\# \cap \readseta_3 = \emptyset$,
    $\writeseta_3 \cap \readseta_\# = \emptyset$. It holds because:
    \begin{itemize}
    \item $\writeseta_\# \cap \readseta_3 = (\writeset_1 \cup \writeset_2) \cap \readset_3 = (\writeset_1 \cap \readset_3) \cup (\writeset_2 \cap \readset_3)$.
      By 15, we have $\writeset_2 \cap \readset_3 = \emptyset$.
      By 16, we have $\readset_3 \subseteq \readset_*$.
      By 11, we have $\writeset_1 \cap \readset_* = \emptyset$. So, $\writeset_1 \cap \readset_3 = \emptyset$.
    \item $\writeseta_3 \cap \readseta_\# = \writeset_3 \cap (\readset_1 \cup \readset_2) = (\writeset_3 \cap \readset_1) \cup (\writeset_3 \cap \readset_2)$.
      By 15, we have $\writeset_3 \cap \readset_2 = \emptyset$.
      By 11, we have $\writeset_* \cap \readset_1 = \emptyset$.
      By 16, we have $\writeset_3 \subseteq \writeset_*$.
      So, $\writeset_3 \cap \readset_1 = \emptyset$.
    \end{itemize}
  
  \item[30]
    %$\readset = \readseta_\# \cup \readseta_3$?
$\readseta_\# \cup \readseta_3 = (\readset_1 \cup \readset_2) \cup \readset_3 = \readset_1 \cup \readset_* = \readset$ (definition and 16 and 12).
    % $\writeset = \writeseta_\# \cup \writeseta_3$?
    $\writeseta_\# \cup \writeseta_3 = (\writeset_1 \cup \writeset_2) \cup \writeset_3 = \writeset_1 \cup \writeset_* = \writeset$ (definition and 16 and 12).
    % $\valuset = \valuseta_\# = \valuseta_3$?
    $\valuset = \valuseta_\# = \valuseta_3$ (definition).
    
  \item[31] $\writeseta'_\# \cap \readseta'_3 = \writeseta'_3 \cap \readseta'_\# = \emptyset$. It holds because:
    \begin{itemize}
    \item $\writeseta'_\# \cap \readseta'_3 = (\writeset'_1 \cup \writeset'_2) \cap \readset'_3$ by definition. It is equal to $(\writeset_1 \cap \readset_3) \cup (\writeset_2 \cap \readset_3)$, by 3, 8, 10. We have $\writeset_1 \cap \readset_* = \emptyset$ (11), and $\readset_3 \subset \readset_*$ (16). So $\writeset_1 \cap \readset_3 = \emptyset$.
      We have $\writeset_2 \cap \readset_3 = \emptyset$ (15).
    \item $\writeseta'_3 \cap \readseta'_\# = \writeseta'_3 \cap (\readset'_1 \cup \readset'_2)$ by definition. It is equal to $(\writeseta_3 \cap \readset_1) \cup (\writeseta_3 \cap \readset_2)$, by 10, 3, 8. We have $\writeset_3 \subseteq \writeset_*$ (16) and $\writeset_* \cap \readset_1 = \emptyset$ (11).
      So $\writeseta_3 \cap \readset_1 = \emptyset$.
      We have $\writeseta_3 \cap \readset_2 = \emptyset$ (15).
    \end{itemize}

  \item[32]
    \begin{itemize}
    \item Instrumental claims:
      \begin{itemize}
  \item(claim~1) $\writeset'_* = \writeset_*$, by 16, 7, 9 and 18.
  \item(claim~2) $\writeset = \writeset'$, by 12, 3, claim~1, 14.
  \item(claim~3) $\writeset_1 \subseteq \writeset'$, by claim~2, and 12.
  \item(claim~4.1) $\writeset_2 \subseteq \writeset'$, by claim~2, 16, and 12.
  \item(claim~4.2) $\writeset_3 \subseteq \writeset'$, by claim~2, 16, and 12.    
  \item(claim~5) $\valuset'_1 \setminus \writeset' = \valuset_1 \setminus \writeset'$, by 3, 12, and claim~2.
  \item(claim~6) $\valuset'_2 \setminus \writeset' = \valuset_2 \setminus \writeset'$, by 8, 16, and 12.
  \item(claim~7) $\valuset'_3 \setminus \writeset' = \valuset_3 \setminus \writeset'$, by 10, 16, and 12.
  \item(claim~8) $\writeset_1 \cap \writeset_2 = \emptyset$, by 11, 12, the `write-set included in read-set' model constraint, and 16.
      \end{itemize}
    \item $\readset' = \readseta'_\# \cup \readseta'_3$ and $\writeset' = \writeseta'_\# \cup \writeseta'_3$ hold by definition, 16 and 12. 

    \item $\valuseta'_\# \setminus \writeset' = \valuseta'_3 \setminus \writeset'$ holds because:
      \begin{itemize}
        \item $\valuseta'_\# \setminus \writeset' = (\valuset_1' \cup \valuset_2') \setminus \writeset'$ by definitions, claim~3, and claim~4.1. By claim~5 and claim~6, it is equal to $(\valuset_1 \cup \valuset_2) \setminus \writeset'$, which by 12 and 16 is $\valuset \setminus \writeset'$.
          %
          \item
      Moreover, $\valuseta'_3 \setminus \writeset' = \valuset'_3 \setminus \writeset'$ by definition. It is equal to $\valuset_3 \setminus \writeset'$ by claim~7, and to $\valuset \setminus \writeset'$ by 12 and 16.
      \end{itemize}
    \item $\valuset' = (\valuseta'_\# \cap \writeseta'_\#) \cup (\valuseta'_3 \cap \writeseta'_3) \cup (\valuseta'_\# \cap \valuseta'_3)$  holds because:
      \begin{itemize}
      \item $\valuseta'_\# \cap \writeseta'_\# = ((\valuset'_1 \cap \writeset'_1) \cup (\valuset'_2 \cap \writeset'_2) \cup (\valuset'_1 \cap \valuset'_2)) \cap (\writeset'_1 \cup \writeset'_2)$ by definition, 3, and 8. We get $(\valuset'_1 \cap \writeset'_1 \cap \writeset'_1) \cup (\valuset'_1 \cap \writeset'_1 \cap \writeset'_2) \cup (\valuset'_2 \cap \writeset'_2 \cap \writeset'_1) \cup (\valuset'_2 \cap \writeset'_2 \cap \writeset'_2) \cup (\valuset'_1 \cap \valuset'_2 \cap \writeset'_1) \cup (\valuset'_1 \cap \valuset'_2 \cap \writeset'_2)$. With elementary set theory simplifications and claim~8, we obtain $(\valuset'_1 \cap \writeset'_1) \cup (\valuset'_2 \cap \writeset'_2)$.
\item $\valuseta'_3 \cap \writeseta'_3 = \valuset'_3 \cap \writeset'_3$.
\item $\valuseta'_\# \cap \valuseta'_3 ((\valuset'_1 \cap \writeset'_1) \cup (\valuset'_2 \cap \writeset'_2) \cup (\valuset'_1 \cap \valuset'_2)) \cap \valuset'_3$ by definition, 3, and 8. We get $(\valuset'_1 \cap \writeset'_1 \cap \valuset'_3) \cup (\valuset'_2 \cap \writeset'_2 \cap \valuset'_3) \cup (\valuset'_1 \cap \valuset'_2 \cap \valuset'_3)$.
\item The rhs quantity $(\valuseta'_\# \cap \writeseta'_\#) \cup (\valuseta'_3 \cap \writeseta'_3) \cup (\valuseta'_\# \cap \valuseta'_3)$ is then equal to
  $(\valuset'_1 \cap \writeset'_1) \cup (\valuset'_2 \cap \writeset'_2) \cup
  (\valuset'_3 \cap \writeset'_3) \cup (\valuset'_1 \cap \valuset'_2 \cap \valuset'_3)$.
\item Moreover, by 14, we have $\valuset' = (\valuset'_1 \cap \writeset'_1) \cup (\valuset'_* \cap \writeset'_*) \cup (\valuset'_1 \cap \valuset'_*)$.
\item By 18, $\valuset'_* = (\valuset'_2 \cap \writeset'_2) \cup (\valuset'_3 \cap \writeset'_3) \cup (\valuset'_1 \cap \valuset'_2)$.
\item By claim~1, $\writeset'_* = \writeset_*$, which by 16 is $\writeset_2 \cup \writeset_3$ which by 8 and 10 is $\writeset'_2 \cup \writeset'_3$. So $\writeset'_2 \subseteq \writeset'_*$ and $\writeset'_3 \subseteq \writeset'_*$.
\item So $(\valuset'_* \cap \writeset'_*) = (\valuset'_2 \cap \writeset'_2) \cup (\valuset'_3 \cap \writeset'_3) \cup (\valuset'_1 \cap \valuset'_2 \cap \writeset'_*)$, with $\valuset'_1 \cap \valuset'_2 \cap \writeset'_* = \valuset'_1 \cap \valuset'_2 \cap (\writeset'_2 \cup \writeset'_3)$ by 18, which is $(\valuset'_2 \cap \valuset'_3 \cap \writeset'_2) \cup (\valuset'_2 \cap \valuset'_3 \cap \writeset'_3)$. So $(\valuset'_* \cap \writeset'_*) = (\valuset'_2 \cap \writeset'_2) \cup (\valuset'_3 \cap \writeset'_3)$.
\item Also $(\valuset'_1 \cap \valuset'_*) = (\valuset'_1 \cap \valuset'_2 \cap \writeset'_2) \cup (\valuset'_1 \cap \valuset'_3 \cap \writeset'_3) \cup (\valuset'_1 \cap \valuset'_2 \cap \valuset'_3)$, with the first two disjuncts included in $\valuset'_* \cap \writeset'_*$.
\item The lhs quantity $V'$ is then equal to $(\valuset'_1 \cap \writeset'_1) \cup (\valuset'_2 \cap \writeset'_2) \cup
  (\valuset'_3 \cap \writeset'_3) \cup (\valuset'_1 \cap \valuset'_2 \cap \valuset'_3)$.
      \end{itemize}
    \end{itemize}

  \end{itemize}


\item[20] if and only if

  \begin{itemize}
  \item[24] if and only if
  \begin{itemize}
  \item[33] $\writeseta_1 \cap \readseta_2 = \emptyset$,
    $\writeseta_2 \cap \readseta_1 = \emptyset$. It holds, because:
    \begin{itemize}

    \item $\writeseta_1 \cap \readseta_2 = \writeset_1 \cap \readset_2$ by definition.
    From 16, $\readset_2 \subseteq \readset_*$. From 11, $\writeset_1 \cap \readset_* = \emptyset$. So $\writeset_1 \cap \readset_2 = \emptyset$.

    \item $\writeseta_2 \cap \readseta_1 = \writeset_2 \cap \readset_1$ by definition.
    From 16, $\writeset_2 \subseteq \writeset_*$. From 11, $\writeset_* \cap \readset_1 = \emptyset$. So $\writeset_2 \cap \readset_1 = \emptyset$.
    \end{itemize}
  \item[34] By definition.
  \item[35] By definition, 33, 3, and 8.
  \item[36] $\readseta_\#' = \readseta'_1 \cup \readseta'_2$, $\writeseta_\#' = \writeseta'_1 \cup \writeseta'_2$, and $\valuseta_\#' = (\valuseta'_1 \cap \writeseta'_1) \cup (\valuseta'_2 \cap \writeseta'_2) \cup (\valuseta'_1 \cap \valuseta'_2)$ by definition.
%
    Also, $\valuseta'_1 \setminus \writeseta_\#' = \valuseta'_2 \setminus \writeseta_\#'$ holds because:
    \begin{itemize}
    \item $\valuseta'_1 \setminus \writeseta_\#' = \valuset'_1 \setminus (\writeset'_1 \cup \writeset'_2)$, which by 3 and 8 is equal to $\valuset_1 \setminus (\writeset_1 \cup \writeset_2)$, which by 12 is equal to $\valuset \setminus (\writeset_1 \cup \writeset_2)$.
      \item Similarly, $\valuseta'_2 \setminus \writeseta_\#'$ is equal to $\valuset \setminus (\writeset_1 \cup \writeset_2)$ by 8, 3, 16 and 12.
    \end{itemize}
  \end{itemize}
\item[25] By definition, and 2.
\item[26] By definition, 3, and 12.
\item[27] By definition, and 7.
\item[28] By definition, 8, 16, and 12.
  \end{itemize}
\item[21] $\readseta_\# = \readseta'_\#$
  and $\writeseta_\# = \writeseta'_\#$ hold by definition, 3, and 8.
  Also by definition, 3, and 8, $\valuseta_\# \setminus \writeseta_\# = \valuseta'_\# \setminus \writeseta'_\#$ is equivalent to $\valuset \setminus (\writeset_1 \cup \writeset_2) = ((\valuset'_1 \cap \writeset'_1) \cup (\valuset'_2 \cap \writeset'_2) \cup (\valuset'_1 \cap \valuset'_2)) \setminus (\writeset_1 \cup \writeset_2)$. The right-hand-side simplifies into $(\valuset'_1 \cap \valuset'_2) \setminus (\writeset_1 \cup \writeset_2)$. Moreover, we have $\valuset'_1 \setminus \writeset'_1 = \valuset \setminus \writeset'_1$ (by 3 and 12) and $\valuset'_2 \setminus \writeset'_2 = \valuset \setminus \writeset'_2$ (by 8, 16, and 12). So we have $\valuset'_1 \setminus (\writeset'_1 \cup \writeset'_2) = \valuset \setminus (\writeset'_1 \cup \writeset'_2)$ and $\valuset'_2 \setminus (\writeset'_1 \cup \writeset'_2) = \valuset \setminus (\writeset'_1 \cup \writeset'_2)$. Hence, $(\valuset'_1 \cap \valuset'_2) \setminus (\writeset_1 \cup \writeset_2)$ simplifies into the left-hand-side $\valuset \setminus (\writeset_1 \cup \writeset_2)$.
\item[22] By definition, and 9.
\item[23] By definition, 10, 16, and 12.
\end{itemize}


\paragraph{Right to left.}

Suppose rhs. We define:
\begin{itemize}
\item $\modl_* = \tuple{\readset_*, \writeset_*, \valuset_*} = \tuple{\readseta_2 \cup \readseta_3, \writeseta_2 \cup \writeseta_3, \valuset}$

\item $\modl_1 = \tuple{\readset_1, \writeset_1, \valuset_1} = \modla_1 = \tuple{\readseta_1, \writeseta_1, \valuseta}$
\item $\modl_2 = \tuple{\readset_2, \writeset_2, \valuset_2} = \modla_2 = \tuple{\readseta_2, \writeseta_2, \valuseta}$
\item $\modl_3 = \tuple{\readset_3, \writeset_3, \valuset_3} = \modla_3 = \tuple{\readseta_3, \writeseta_3, \valuseta}$  

\item $\modl'_* = \tuple{\readset'_*, \writeset'_*, \valuset'_*} = \tuple{\readseta'_2 \cup \readseta'_3, \writeseta'_2 \cup \writeseta'_3, (\valuseta'_2 \cap \writeseta_2) \cup (\valuseta'_3 \cap \writeseta_3) \cup (\valuseta'_2 \cap \valuseta'_3)}$
  
\item $\modl'_1 = \tuple{\readset'_1, \writeset'_1, \valuset'_1} = \modla'_1 = \tuple{\readseta'_1, \writeseta'_1, \valuseta'_1}$
\item $\modl'_2 = \tuple{\readset'_2, \writeset'_2, \valuset'_2} = \modla'_2 = \tuple{\readseta'_2, \writeseta'_2, \valuseta'_2}$
\item $\modl'_3 = \tuple{\readset'_3, \writeset'_3, \valuset'_3} = \modla'_3 = \tuple{\readseta'_3, \writeseta'_3, \valuseta'_3}$ 
\end{itemize}

We must show that these models satisfy all the properties from~\ref{i:lhsfirst} through~\ref{i:lhslast}. This is done routinely, analogously to the proof of the left-to-right direction above.
\end{proof}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "x_dlpa4para.tex"
%%% End:
